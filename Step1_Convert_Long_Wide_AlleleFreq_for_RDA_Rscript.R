
#Create dataframe of North American individuals to subset
library(data.table)
library(tidyr)

#Open Frequency (long format) data - created using plink '--freq --family'
#Plink and bed file 
#
plink<-"~/Desktop/Software/plink_mac/"
bfile <-"~/Dropbox/Desktop/postdocwork/Salmon/GenomicVulnerability/PCAdapt/NorthAM_86pops_goodloc_maf005" #don't inlcude .bed 

system(paste0("cd ", plink,"; ./plink --bfile ", bfile, " --freq --family --allow-extra-chr --chr-set 30 --out ", bfile,"_AlleleFrequencies") )

new_freq_path<-paste0(bfile,"_AlleleFrequencies.frq.strat")
freq=fread(input = new_freq_path, header=T)

#Change to wide foramt using spread() function
test=spread(data = freq[,c(2,3,6)],key = "SNP",value = "MAF")

#Save for RDA analysis - Population level allele frequencies
fwrite(test,"/Users/LehnertS/Desktop/Salmon_vulnerability/NorthAM_AlleleFreq_95k_maf005.txt", quote = F, row.names = F, col.names = T, sep="\t")
